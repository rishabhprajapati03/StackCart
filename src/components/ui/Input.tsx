import React, { forwardRef } from "react";

interface InputProps extends React.InputHTMLAttributes<HTMLInputElement> {
  error?: string | null;
  success?: boolean;
  label?: string;
}

const Input = forwardRef<HTMLInputElement, InputProps>(
  ({ label, error, success, className = "", ...props }, ref) => {
    const containerBase = "flex flex-col gap-1 w-full md:max-w-md";

    const inputBase =
      "w-full px-4 py-4 rounded-xl font-medium border transition-all duration-200 outline-none text-base";

    const states = {
      default: "border-[#E6E6E6] bg-white placeholder-[#999999] text-gray-400",
      hover: "hover:border-black",
      filled: "text-black border-gray-200 focus:border-black",
      success: "border-green-600 text-black",
      error: "border-red-500 text-black",
    };

    let currentState = states.filled;
    if (error) currentState = states.error;
    else if (success) currentState = states.success;

    return (
      <div className={containerBase}>
        {label && <label className="text-base font-medium">{label}</label>}
        <div className="relative flex items-center">
          <input
            ref={ref}
            className={`${inputBase} ${states.hover} ${currentState} ${className}`}
            {...props}
          />

          {/* Right-side Icons */}
          <div className="absolute right-4 flex items-center pointer-events-none">
            {success && !error && (
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M16.5459 8.95406C16.6508 9.05858 16.734 9.18277 16.7908 9.31952C16.8476 9.45626 16.8768 9.60287 16.8768 9.75094C16.8768 9.899 16.8476 10.0456 16.7908 10.1824C16.734 10.3191 16.6508 10.4433 16.5459 10.5478L11.2959 15.7978C11.1914 15.9027 11.0672 15.9859 10.9305 16.0427C10.7937 16.0995 10.6471 16.1287 10.4991 16.1287C10.351 16.1287 10.2044 16.0995 10.0676 16.0427C9.9309 15.9859 9.80671 15.9027 9.70219 15.7978L7.45219 13.5478C7.34754 13.4432 7.26453 13.3189 7.2079 13.1822C7.15127 13.0455 7.12212 12.8989 7.12212 12.7509C7.12212 12.6029 7.15127 12.4564 7.2079 12.3197C7.26453 12.1829 7.34754 12.0587 7.45219 11.9541C7.55684 11.8494 7.68107 11.7664 7.8178 11.7098C7.95453 11.6531 8.10107 11.624 8.24907 11.624C8.39706 11.624 8.5436 11.6531 8.68033 11.7098C8.81706 11.7664 8.94129 11.8494 9.04594 11.9541L10.5 13.4062L14.9541 8.95125C15.0587 8.84684 15.183 8.76408 15.3196 8.7077C15.4563 8.65133 15.6027 8.62245 15.7506 8.62271C15.8984 8.62297 16.0448 8.65237 16.1812 8.70922C16.3177 8.76608 16.4416 8.84928 16.5459 8.95406ZM22.125 12C22.125 14.0025 21.5312 15.9601 20.4186 17.6251C19.3061 19.2902 17.7248 20.5879 15.8747 21.3543C14.0246 22.1206 11.9888 22.3211 10.0247 21.9305C8.06066 21.5398 6.25656 20.5755 4.84055 19.1595C3.42454 17.7435 2.46023 15.9393 2.06955 13.9753C1.67888 12.0112 1.87939 9.97543 2.64572 8.12533C3.41206 6.27523 4.70981 4.69392 6.37486 3.58137C8.0399 2.46882 9.99747 1.875 12 1.875C14.6844 1.87798 17.258 2.94567 19.1562 4.84383C21.0543 6.74199 22.122 9.3156 22.125 12ZM19.875 12C19.875 10.4425 19.4131 8.91992 18.5478 7.62488C17.6825 6.32985 16.4526 5.32049 15.0136 4.72445C13.5747 4.12841 11.9913 3.97246 10.4637 4.27632C8.93607 4.58017 7.53288 5.3302 6.43154 6.43153C5.3302 7.53287 4.58018 8.93606 4.27632 10.4637C3.97246 11.9913 4.12841 13.5747 4.72445 15.0136C5.32049 16.4526 6.32985 17.6825 7.62489 18.5478C8.91993 19.4131 10.4425 19.875 12 19.875C14.0879 19.8728 16.0896 19.0424 17.566 17.566C19.0424 16.0896 19.8728 14.0879 19.875 12Z"
                  fill="#0C9409"
                />
              </svg>
            )}
            {error && (
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12 1.875C9.99747 1.875 8.0399 2.46882 6.37486 3.58137C4.70981 4.69392 3.41206 6.27523 2.64572 8.12533C1.87939 9.97543 1.67888 12.0112 2.06955 13.9753C2.46023 15.9393 3.42454 17.7435 4.84055 19.1595C6.25656 20.5755 8.06066 21.5398 10.0247 21.9305C11.9888 22.3211 14.0246 22.1206 15.8747 21.3543C17.7248 20.5879 19.3061 19.2902 20.4186 17.6251C21.5312 15.9601 22.125 14.0025 22.125 12C22.122 9.3156 21.0543 6.74199 19.1562 4.84383C17.258 2.94567 14.6844 1.87798 12 1.875ZM12 19.875C10.4425 19.875 8.91993 19.4131 7.62489 18.5478C6.32985 17.6825 5.32049 16.4526 4.72445 15.0136C4.12841 13.5747 3.97246 11.9913 4.27632 10.4637C4.58018 8.93606 5.3302 7.53287 6.43154 6.43153C7.53288 5.3302 8.93607 4.58017 10.4637 4.27632C11.9913 3.97246 13.5747 4.12841 15.0136 4.72445C16.4526 5.32049 17.6825 6.32985 18.5478 7.62488C19.4131 8.91992 19.875 10.4425 19.875 12C19.8728 14.0879 19.0424 16.0896 17.566 17.566C16.0896 19.0424 14.0879 19.8728 12 19.875ZM10.875 12.375V7.5C10.875 7.20163 10.9935 6.91548 11.2045 6.7045C11.4155 6.49353 11.7016 6.375 12 6.375C12.2984 6.375 12.5845 6.49353 12.7955 6.7045C13.0065 6.91548 13.125 7.20163 13.125 7.5V12.375C13.125 12.6734 13.0065 12.9595 12.7955 13.1705C12.5845 13.3815 12.2984 13.5 12 13.5C11.7016 13.5 11.4155 13.3815 11.2045 13.1705C10.9935 12.9595 10.875 12.6734 10.875 12.375ZM13.5 16.125C13.5 16.4217 13.412 16.7117 13.2472 16.9584C13.0824 17.205 12.8481 17.3973 12.574 17.5108C12.2999 17.6244 11.9983 17.6541 11.7074 17.5962C11.4164 17.5383 11.1491 17.3954 10.9393 17.1857C10.7296 16.9759 10.5867 16.7086 10.5288 16.4176C10.4709 16.1267 10.5007 15.8251 10.6142 15.551C10.7277 15.2769 10.92 15.0426 11.1666 14.8778C11.4133 14.713 11.7033 14.625 12 14.625C12.3978 14.625 12.7794 14.783 13.0607 15.0643C13.342 15.3456 13.5 15.7272 13.5 16.125Z"
                  fill="#ED1010"
                />
              </svg>
            )}
          </div>
        </div>

        {/* Error text */}
        {error && (
          <span className="text-red-600 text-sm font-medium ml-1">{error}</span>
        )}
      </div>
    );
  }
);

Input.displayName = "Input";

export default Input;
